<link rel="stylesheet" href="/css/referral.css">

<div class="referral-container">
    <div class="referral-header">
        <h1>Referral Program</h1>

    </div>

    <div class="referral-card">
        <h2>Your Referral Link</h2>
        <div class="referral-link-container">
            <div class="referral-link" id="referralLink"><%= referralLink %></div>
            <div class="copy-btn-container">
                <button class="copy-btn" onclick="copyToClipboard()">Copy</button>
            </div>
        </div>
    </div>

    <div class="referral-card">
        <h2>Your Stats</h2>
        <div class="referral-stats">
            <div class="stat-item">
                <h3><%= user.referralBonuses || 0 %></h3>
                <p>Bonus Balance</p>
            </div>
            <div class="stat-item">
                <h3><%= referredUsers.length %></h3>
                <p>Referred Users</p>
            </div>
            <% if (user.referredBy) { %>
            <div class="stat-item">
                <h3><%= user.referredBy.name %></h3>
                <p>Referred By</p>
            </div>
            <% } %>
        </div>
    </div>

    <div class="referral-card">
        <h2>Users You Referred</h2>
        <div class="table-responsive">
            <table class="referred-users-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Date Registered</th>
                    </tr>
                </thead>
                <tbody>
                    <% referredUsers.forEach(function(referredUser) { %>
                        <tr>
                            <td><%= referredUser.name %></td>
                            <td><%= referredUser.email %></td>
                            <td><%= referredUser.date_registered.toLocaleDateString() %></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
function copyToClipboard() {
    const referralLink = document.getElementById('referralLink');
    const range = document.createRange();
    range.selectNode(referralLink);
    window.getSelection().removeAllRanges();
    window.getSelection().addRange(range);
    document.execCommand('copy');
    window.getSelection().removeAllRanges();
    alert('Referral link copied to clipboard!');
}
</script>