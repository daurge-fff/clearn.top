<div class="container">
    <div class="page-header">
        <h1>Lesson Schedule</h1>
        <div class="page-actions">
            <a href="/dashboard/lessons/add" class="btn btn-primary"><i class="icon-add"></i> Schedule a Lesson</a>
        </div>
    </div>

    <div class="card">
        <h2>Upcoming & Recent Lessons</h2>
        <% if (lessons && lessons.length > 0) { %>
            <div class="table-responsive">
                <table class="data-table compact">
                    <thead>
                        <tr>
                            <th class="col-datetime">Date & Time</th>
                            <th class="col-student">Student</th>
                            <th class="col-course">Course</th>
                            <th class="col-status">Status</th>
                            <th class="col-actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% lessons.forEach(lesson => { %>
                            <tr>
                                <td class="col-datetime nowrap"><%= new Date(lesson.localLessonDate).toLocaleString('en-GB', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' }) %></td>
                                <td class="col-student">
                                    <% if (lesson.student) { %>
                                        <a href="/dashboard/student/<%= lesson.student._id %>" class="link-discreet truncate" title="<%= lesson.student.name %>"><%= lesson.student.name %></a>
                                    <% } else { %>
                                        Student not found
                                    <% } %>
                                </td>
                                <td class="col-course">
                                    <% if (lesson.lessonNumber) { %>
                                        <span class="muted">#<%= lesson.lessonNumber %></span>
                                    <% } %>
                                    <span class="truncate" title="<%= (lesson.course ? lesson.course.name : 'N/A') %>"><%= lesson.course ? lesson.course.name : 'N/A' %></span>
                                </td>
                                <td class="col-status"><span class="badge status-<%= lesson.status %>"><%= lesson.status.replace(/_/g, ' ') %></span></td>
                                <td class="col-actions actions-cell">
                                    <a href="/dashboard/lessons/manage/<%= lesson._id %>" class="btn-icon" data-tooltip="Manage Lesson"><i class="icon-edit"></i></a>
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        <% } else { %>
            <div class="empty-state">
                <div class="empty-state-icon"><i class="icon-inbox"></i></div>
                <h3>No Lessons Scheduled</h3>
                <p>You have no upcoming or past lessons. Schedule one to get started.</p>
            </div>
        <% } %>
    </div>
</div>